/**
 * Building Evaluation Report - Print Styles
 * Based on coordinates from DocumentGenerationServiceImpl.kt (Aspose)
 *
 * A4 Landscape: 297mm × 210mm
 * Points per mm: 2.834647454889553
 *
 * Key measurements from Aspose:
 * - Cover photo: 400×230pt (~141×81mm)
 * - Location map: 360×360pt (~127×127mm)
 * - Page margins: 15mm top, 20mm right/bottom/left
 */

/* =============================================================================
   CSS VARIABLES - Now on .report-page for WYSIWYG preview
   ============================================================================= */

/* .evaluation-report wrapper needs no styles - parent provides background */
.evaluation-report {
	/* Empty - kept for structure only */
}

/* =============================================================================
   PAGE RULES
   ============================================================================= */

@page {
	size: A4 landscape;
	/* Set to 0 to prevent browser from adding its own header/footer */
	/* Content spacing is handled by .report-page padding */
	margin: 0;
}

/* =============================================================================
   PAGE CONTAINERS - WYSIWYG A4 Pages
   ============================================================================= */

.report-page {
	/* Colors matching backend */
	--color-condition-very-bad: #e54f29;
	--color-condition-bad: #faa724;
	--color-condition-ok: #78c06b;
	--color-condition-good: #338721;
	--color-condition-unknown: #999999;

	/* Chart colors */
	--color-original-value: #1890ff;
	--color-time-value: #52c41a;
	--color-maintenance: #faad14;
	--color-restoration: #ff4d4f;

	/* Page dimensions (A4 Landscape) */
	--page-width: 297mm;
	--page-height: 210mm;
	--margin-top: 15mm;
	--margin-right: 20mm;
	--margin-bottom: 15mm;
	--margin-left: 20mm;
	--content-width: calc(297mm - 40mm);
	/* 257mm */
	--content-height: calc(210mm - 35mm);
	/* 175mm */

	/* Sizing from Aspose (converted to mm) */
	--cover-photo-width: 141mm;
	/* 400pt */
	--cover-photo-height: 81mm;
	/* 230pt */
	--cover-photo-top: 60mm;
	/* 170pt */
	--location-map-size: 127mm;
	/* 360pt */

	/* Typography */
	--font-family: var(--font-family);
	--font-size-base: 10pt;
	--font-size-small: 8pt;
	--font-size-title: 16pt;
	--font-size-heading: 12pt;

	/* Base typography */
	font-family: var(--font-family);
	font-size: var(--font-size-base);
	line-height: 1.4;
	color: #333;

	/* WYSIWYG: Full A4 page with print margins as padding */
	width: var(--page-width);
	min-height: var(--page-height);
	padding: var(--margin-top) var(--margin-right) var(--margin-bottom) var(--margin-left);
	box-sizing: border-box;
	background: white;

	/* Print behavior */
	page-break-after: always;
	break-after: page;
	position: relative;
}

.report-page * {
	box-sizing: border-box;
}

.report-page:last-child {
	page-break-after: auto;
	break-after: auto;
}

.page-break {
	break-before: page;
	page-break-before: always;
}

.avoid-break {
	break-inside: avoid;
	page-break-inside: avoid;
}

/* =============================================================================
   REPORT HEADER & FOOTER
   ============================================================================= */

.report-header {
	display: flex;
	justify-content: space-between;
	align-items: flex-start;
	margin-bottom: 12px;
	min-height: 24px;
}

.report-header-left {
	font-size: 9pt;
	color: #333;
	flex: 1;
}

.report-header-right {
	flex-shrink: 0;
}

.report-logo {
	height: 24px;
	width: auto;
	object-fit: contain;
}

.report-footer {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-top: auto;
	padding-top: 12px;
	font-size: 8pt;
	color: #666;
}

.report-footer-left {
	flex: 1;
	text-align: left;
}

.report-footer-center {
	flex: 1;
	text-align: center;
}

.report-footer-right {
	flex: 1;
	text-align: right;
}

/* Page layout with header/footer */
.report-page-content {
	display: flex;
	flex-direction: column;
	height: 100%;
	/* Fill the content area within the page padding */
}

.report-page-body {
	flex: 1;
}

/* =============================================================================
   COVER PAGE (Page 1)
   Pixel-perfect layout matching original Aspose Word template.

   A4 Landscape: 297mm × 210mm
   Margins: 15mm top, 20mm right/bottom/left
   Content area: 257mm × 175mm

   Measurements from Aspose DocumentGenerationServiceImpl.kt:
   - Photo: 400×230pt = 141×81mm
   - Photo top offset: 170pt = 60mm from content top
   - Photo right offset: 20pt from right margin
   ============================================================================= */

.cover-page-body {
	position: relative;
	width: 100%;
	height: 100%;
}

/* Account name - top left, gray, regular weight */
.cover-account-name {
	position: absolute;
	top: 0;
	left: 0;
	font-size: 16pt;
	font-style: normal;
	font-weight: 400;
	color: #666;
	margin: 0;
	line-height: 1.2;
}

/* Building name - bold, black, below account name */
.cover-building-name {
	position: absolute;
	top: 8mm;
	/* Below account name with ~2mm gap */
	left: 0;
	font-size: 24pt;
	font-weight: 700;
	color: #333;
	margin: 0;
	line-height: 1.2;
}

/* Photo container - right side, from Aspose: top=170pt=60mm, right aligned */
.cover-photo-container {
	position: absolute;
	top: 45mm;
	/* Aspose 170pt ≈ 60mm, adjusted for visual match */
	right: 0;
	overflow: hidden;
	background: #f5f5f5;
}

.cover-photo {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.cover-photo-placeholder {
	width: 100%;
	height: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
	color: #999;
	font-size: 12pt;
}

/* "Strategische Unterhaltsplanung" - bottom left */
.cover-strategic-label {
	position: absolute;
	bottom: 35mm;
	/* ~35mm from content bottom */
	left: 0;
	font-size: 11pt;
	font-style: normal;
	font-weight: 400;
	color: #333;
	margin: 0;
	line-height: 1.2;
}

/* "Objektauswertung" - below strategic label, bold */
.cover-report-type {
	position: absolute;
	bottom: 20mm;
	/* ~20mm from content bottom */
	left: 0;
	font-size: 18pt;
	font-style: normal;
	font-weight: 700;
	color: #333;
	margin: 0;
	line-height: 1.2;
}

/* =============================================================================
   DATA PAGE (Page 2)
   Matching original Aspose PDF layout with numbered section headers
   ============================================================================= */

.data-page {
	display: flex;
	gap: 24px;
}

.data-tables {
	flex: 1;
	display: flex;
	flex-direction: column;
	gap: 20px;
}

/* Numbered section header with underline (e.g., "1. Grunddaten") */
.data-section-header {
	font-size: 14pt;
	font-weight: 700;
	margin: 0 0 8px 0;
	padding-bottom: 4px;
	border-bottom: 1px solid #333;
}

/* Simple data table without borders - matching Aspose layout */
.data-table-simple {
	width: 100%;
	border-collapse: collapse;
	table-layout: auto;
}

.data-table-simple th,
.data-table-simple td {
	padding: 3px 0;
	vertical-align: top;
	border: none;
}

.data-table-simple th {
	text-align: left;
	font-weight: var(--font-weight-normal);
	color: #333;
	/* Allow labels to wrap if needed, but values should not */
}

.data-table-simple td {
	text-align: right;
	font-weight: var(--font-weight-bold);
	white-space: nowrap;
}

/* Location section container (right column) */
.data-location-section {
	display: flex;
	flex-direction: column;
	flex-shrink: 0;
}

.location-map-container {
	/* Size: 127mm (360pt) from Aspose */
	width: var(--location-map-size);
	height: var(--location-map-size);
	overflow: hidden;
	background: #f5f5f5;
}

.location-map {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.location-address {
	margin-top: 8px;
	font-size: var(--font-size-base);
	color: #333;
}

/* =============================================================================
   ELEMENTS PAGE (Page 4) - Datenerhebung am Objekt
   Simple 4-column table: Bauteil | Beschreibung | Anteil | Zustand
   ============================================================================= */

/* Data Collection Table */
.data-collection-table {
	width: 100%;
	border-collapse: collapse;
	font-size: var(--font-size-base);
}

.data-collection-table thead tr {
	border-top: 1px solid #333;
	border-bottom: 1px solid #333;
	background-color: #f0f0f0;
}

.data-collection-table th {
	padding: 6px 8px;
	text-align: left;
	font-weight: var(--font-weight-bold);
	color: #333;
	vertical-align: bottom;
}

.data-collection-table th.col-bauteil {
	width: 200px;
}

.data-collection-table th.col-beschreibung {
	/* Takes remaining space */
}

.data-collection-table th.col-anteil {
	width: 60px;
	text-align: right;
}

.data-collection-table th.col-zustand {
	width: 80px;
	text-align: right;
}

.data-collection-table tbody tr {
	border-bottom: 1px solid #e0e0e0;
	break-inside: avoid;
	page-break-inside: avoid;
}

.data-collection-table td {
	padding: 8px;
	vertical-align: top;
}

/* Element name cell */
.element-name-cell {
	font-weight: var(--font-weight-medium);
	color: #1890ff;
}

/* Combined description cell */
.element-description-cell {
	color: #333;
}

.description-combined {
	display: flex;
	flex-direction: column;
	gap: 2px;
}

.description-line {
	line-height: 1.4;
}

.description-line strong {
	color: #1890ff;
}

/* Weight cell */
.element-weight-cell {
	text-align: right;
	font-weight: var(--font-weight-medium);
}

/* Condition cell with square indicator */
.element-condition-cell {
	text-align: right;
	white-space: nowrap;
}

.condition-value {
	margin-right: 6px;
}

.condition-square {
	display: inline-block;
	width: 12px;
	height: 12px;
	vertical-align: middle;
	flex-shrink: 0;
}

/* Condition dot (used elsewhere, e.g. summary) */
.condition-dot {
	width: 10px;
	height: 10px;
	border-radius: 50%;
	flex-shrink: 0;
}

/* =============================================================================
   RENOVATION TIMELINE PAGE
   ============================================================================= */

.renovation-timeline-page {
	break-inside: avoid;
}

.renovation-timeline {
	width: 100%;
	border-collapse: collapse;
	font-size: var(--font-size-small);
}

.renovation-timeline th,
.renovation-timeline td {
	padding: 4px 2px;
	text-align: center;
	white-space: nowrap;
}

/* Horizontal borders */
.renovation-timeline thead {
	border-top: 1px solid #333;
	border-bottom: 1px solid #333;
	background-color: #f5f5f5;
}

.renovation-timeline tbody tr {
	border-bottom: 1px solid #e0e0e0;
}

/* Remove border from row before total so borders match */
.renovation-timeline tbody tr:nth-last-child(2) {
	border-bottom: none;
}

.renovation-timeline tr.total-row {
	border-top: 1px solid #666;
	border-bottom: 1px solid #666;
	font-weight: var(--font-weight-bold);
}

/* Period header row (Kurzfr., Mittelfristig, Langfristig) */
.renovation-timeline .period-header-row th {
	font-weight: var(--font-weight-bold);
	padding: 4px 2px;
	border-bottom: 1px solid #e0e0e0;
}

.renovation-timeline .period-header-row th.period-col {
	border-left: 1px dashed #ccc;
	border-right: 1px dashed #ccc;
}

.renovation-timeline .period-header-row th.period-col:first-of-type {
	border-left: 1px dashed #ccc;
}

/* Element column */
.renovation-timeline th.element-col {
	text-align: left;
	width: 180px;
	font-weight: var(--font-weight-bold);
}

/* Year columns - rotated 90 degrees */
.renovation-timeline th.year-col {
	width: 22px;
	min-width: 22px;
	max-width: 22px;
	height: 50px;
	padding: 2px 0;
	vertical-align: bottom;
	text-align: center;
	border-left: 1px dashed #ccc;
	border-right: none;
}

.renovation-timeline th.year-col:last-of-type {
	border-right: 1px dashed #ccc;
}

.renovation-timeline th.year-col .year-label {
	display: inline-block;
	writing-mode: vertical-rl;
	transform: rotate(180deg);
	font-size: 7pt;
	font-weight: var(--font-weight-bold);
	line-height: 1;
}

/* Result columns (Jahr, Kosten) */
.renovation-timeline th.result-col {
	width: 55px;
	font-weight: var(--font-weight-bold);
	border-left: 1px dashed #ccc;
}

/* Year cells in body - dashed vertical borders */
.renovation-timeline td.year-cell {
	border-left: 1px dashed #ccc;
	border-right: none;
}

.renovation-timeline tbody tr td.year-cell:last-of-type {
	border-right: 1px dashed #ccc;
}

/* Element name - plain text, left aligned */
.renovation-timeline td.element-name {
	text-align: left;
	font-weight: var(--font-weight-normal);
}

/* Renovation marker */
.renovation-timeline td.year-marker {
	vertical-align: middle;
}

.renovation-timeline td.year-marker .marker-dot {
	display: inline-block;
	width: 14px;
	height: 14px;
	background-color: #1a5fb4;
	border-radius: 50%;
	vertical-align: middle;
}

/* Result cells */
.renovation-timeline td.result-year,
.renovation-timeline td.result-cost {
	text-align: right;
	font-weight: var(--font-weight-normal);
	border-left: 1px dashed #ccc;
}

.renovation-timeline td.result-year {
	padding-right: 8px;
}

/* =============================================================================
   CHARTS PAGE
   Print-optimized layout matching Aspose template:
   - Single section header
   - No borders, no individual titles
   - Compact legends
   - 30%/70% height split
   ============================================================================= */

.charts-page {
	display: flex;
	flex-direction: column;
}

.charts-page-body {
	display: flex;
	flex-direction: column;
	flex: 1;
	gap: 8px;
}

/* Chart areas - no borders, just the chart */
.chart-area {
	display: flex;
	flex-direction: column;
}

/* Value chart - 30% height (~40mm) */
.chart-area-value {
	height: 40mm;
	flex-shrink: 0;
}

/* Cost chart - 70% height (~100mm) */
.chart-area-cost {
	height: 100mm;
	flex-shrink: 0;
}

/* Legacy container styles (keep for backward compatibility) */
.chart-container {
	border: 1px solid #e0e0e0;
	border-radius: 4px;
	padding: 12px 16px;
	display: flex;
	flex-direction: column;
}

.chart-title {
	font-size: var(--font-size-heading);
	font-weight: var(--font-weight-bold);
	margin: 0 0 8px 0;
	flex-shrink: 0;
}

.chart-content {
	flex: 1;
	min-height: 0;
}

.chart-image {
	width: 100%;
	height: 100%;
	object-fit: contain;
}

/* =============================================================================
   COSTS TABLE PAGE (spanning multiple pages)
   ============================================================================= */

.costs-table {
	width: 100%;
	border-collapse: collapse;
	font-size: var(--font-size-small);
}

.costs-table th,
.costs-table td {
	padding: 4px 8px;
	text-align: right;
	border: 1px solid #e0e0e0;
	white-space: nowrap;
}

.costs-table th {
	background: #fafafa;
	font-weight: var(--font-weight-bold);
	text-align: center;
}

.costs-table th:first-child,
.costs-table td:first-child {
	text-align: center;
}

.costs-table td.element-name {
	text-align: left;
}

.costs-table tr {
	break-inside: avoid;
	page-break-inside: avoid;
}

.costs-table tbody tr:nth-child(even) {
	background: #fafafa;
}

/* Sub-rows styling - no bottom border for visual grouping */
.costs-table .costs-table-subrow td {
	border-bottom: none;
}

/* =============================================================================
   SUMMARY PAGE (One-Pager) - Fixed A4 Layout
   Four quadrants with pixel-perfect alignment using mm units:
   - Upper-left: Parameter tables (Grunddaten + Auswertung)
   - Upper-right: Cost bar chart (Recharts)
   - Lower-left: Element table (name, weight, %, Z/N scatter)
   - Lower-right: Renovation timeline (dots per year)
   
   A4 Landscape content area: 270mm × ~160mm (after margins)
   ============================================================================= */

.summary-page {
	/* Fixed measurements from A4 layout */
	--col-name: 45mm;
	--col-weight: 14.5mm;
	--col-percent: 10mm;
	--col-zn-scatter: 54mm;
	/* 4mm padding + 50mm scale */
	--col-zn-value: 6mm;
	/* Z/N value column width */
	--col-gap: 6mm;
	--col-year: 4.7mm;
	--year-count: 26;
	--upper-height: 76mm;
	--header-row-height: 5.5mm;
	--header-row-gap: 5mm;
	--left-panel-width: 130mm;
	--right-panel-width: 130mm;
	--content-width: 270mm;

	display: flex;
	flex-direction: column;
}

.summary-body {
	position: relative;
	flex: 1;
	width: var(--content-width);
}

/* Full-height year grid overlay - spans from chart to table for alignment verification
   Positioned at: left-panel-width (130mm) + Y-axis (5.5mm) = 135.5mm from left
   Starts below chart title, ends above year labels and footer */
.summary-year-grid-overlay {
	position: absolute;
	top: calc(var(--header-row-height) + 5mm);
	/* Start below section headers */
	bottom: 28mm;
	/* Leave space for year labels + footer labels */
	left: calc(var(--left-panel-width) + 5.5mm);
	width: calc(var(--year-count) * var(--col-year));
	display: grid;
	grid-template-columns: repeat(var(--year-count), var(--col-year));
	pointer-events: none;
	z-index: 10;
}

.summary-year-grid-line {
	border-left: 1px dashed #ccc;
}

.summary-year-grid-line:last-child {
	border-right: 1px dashed #ccc;
}

/* -----------------------------------------------------------------------------
   UPPER SECTION: Parameter tables + Cost chart (absolute positioning)
   Height: 67.5mm, split at 135mm vertical divider
   ----------------------------------------------------------------------------- */

/* Section headers row ("Auf einen Blick" and chart title) */
.summary-header-row {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	height: var(--header-row-height);
	display: flex;
	font-size: 9pt;
	font-weight: var(--font-weight-bold);
	color: #333;
	padding-top: 2mm;
}

.section-header {
	border-bottom: 1px solid #333;
	padding-bottom: 1mm;
}

.section-header-left {
	width: calc(var(--left-panel-width) - 6mm);
	margin-right: 6mm;
}

.section-header-right {
	/* Left-align, width matches chart area */
	width: calc(var(--year-count) * var(--col-year));
	margin-left: 6mm;
}

.summary-upper {
	position: absolute;
	top: calc(var(--header-row-height) + var(--header-row-gap));
	left: 0;
	right: 0;
	height: calc(var(--upper-height) - var(--header-row-height));
	display: flex;
}

/* Parameter tables (left side) - 0 to 135mm */
.summary-params {
	width: var(--left-panel-width);
	display: flex;
	flex-direction: column;
	gap: 6px;
	padding-right: 6mm;
}

.params-header {
	font-size: 8pt;
	font-weight: var(--font-weight-bold);
	/* padding: 2px 6px;
	background: #f5f5f5;
	border: 1px solid #333; */
}

.params-table {
	width: 100%;
	border-collapse: collapse;
	font-size: 8pt;
}

.params-table tr {
	border-bottom: 1px solid #ccc;
}

.params-table th,
.params-table td {
	padding: 2px 6px;
	vertical-align: top;
}

.params-table th {
	text-align: left;
	font-weight: var(--font-weight-normal);
	color: #333;
	width: 60%;
}

.params-table td {
	text-align: right;
	font-weight: var(--font-weight-bold);
	white-space: nowrap;
}

/* Cost chart container (right side) - aligned with year columns
   Year columns start at 135.5mm (after left table columns + gap)
   Chart container starts at 130mm, Y-axis (5.5mm) provides offset
   Year columns span: 26 × 4.7mm = 122.2mm */
.summary-chart-container {
	/* Width: Y-axis area (5.5mm) + year columns width */
	width: calc(5.5mm + var(--year-count) * var(--col-year));
	display: flex;
	flex-direction: column;
}

/* -----------------------------------------------------------------------------
   COST BAR CHART (upper right quadrant) - Recharts
   ----------------------------------------------------------------------------- */

.summary-cost-chart {
	display: flex;
	flex-direction: column;
	height: 100%;
}

.cost-chart-wrapper {
	flex: 1;
	width: 100%;
	min-height: 0;
	display: flex;
	position: relative;
}

/* Y-axis area - extends left into params area via negative margin */
.cost-chart-yaxis {
	width: 12mm;
	margin-left: -6.5mm;
	/* Extend left: 12mm - 5.5mm = 6.5mm overflow */
	flex-shrink: 0;
}

/* Bar chart area - matches year columns width */
.cost-chart-bars {
	flex: 1;
	position: relative;
	width: calc(var(--chart-year-count, 26) * var(--col-year));
}

/* CSS grid overlay for year column borders */
.cost-chart-grid-overlay {
	position: absolute;
	top: 5px;
	left: 0;
	right: 0;
	bottom: 25px;
	/* Leave space for X-axis labels */
	display: grid;
	grid-template-columns: repeat(var(--chart-year-count, 26), 1fr);
	pointer-events: none;
	z-index: 1;
}

.cost-chart-grid-cell {
	border-left: 1px dashed #e0e0e0;
}

.cost-chart-grid-cell:last-child {
	border-right: 1px dashed #e0e0e0;
}

/* Chart content - sits behind the grid overlay */
.cost-chart-content {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
}

/* Chart legend */
.cost-chart-legend {
	display: flex;
	justify-content: center;
	gap: 16px;
	font-size: 7pt;
	margin-top: 4px;
}

.legend-item {
	display: flex;
	align-items: center;
	gap: 4px;
}

.legend-color {
	width: 12px;
	height: 8px;
}

.legend-maintenance {
	background-color: #4b873c;
}

.legend-restoration {
	background-color: #a0cd5f;
}

/* -----------------------------------------------------------------------------
   LOWER SECTION: Element table + Timeline (fixed mm columns)
   Starts at 67.5mm from top
   ----------------------------------------------------------------------------- */

.summary-lower {
	position: absolute;
	top: calc(var(--upper-height) + var(--header-row-height));
	left: 0;
	right: 0;
	bottom: 0;
	display: flex;
	flex-direction: column;
}

/* Grid footer labels (Baustruktur, Baulicher Zustand, Instandsetzungszeitpunkte) */
.summary-grid-footer {
	display: flex;
	font-size: 12px;
	font-weight: var(--font-weight-bold);
	padding: 4px 0;
	margin-top: 2px;
	color: #333;
}

.footer-structure-label {
	width: calc(var(--col-name) + var(--col-weight) + var(--col-percent));
	/* justify-content: space-between; */
	border-top: 1px solid #333;
}

.footer-condition-label {
	width: calc(var(--col-zn-scatter) - 4mm);
	/* justify-content: space-between; */
	margin-left: 4mm;
	border-top: 1px solid #333;
}

.footer-timeline-label {
	width: calc(var(--year-count) * var(--col-year));
	margin-left: calc(var(--col-zn-value) + var(--col-gap));
	border-top: 1px solid #333;
}

.footer-zn-label {
	width: var(--col-zn-scatter);
	text-align: center;
	color: #333;
}

/* Unified grid - fixed mm-based columns */
/* Columns: name | weight | % | Z/N scatter | Z/N value | gap | years... */
.summary-grid {
	display: grid;
	grid-template-columns:
		var(--col-name) var(--col-weight) var(--col-percent) var(--col-zn-scatter) var(--col-zn-value) var(--col-gap) repeat(var(--year-count), var(--col-year));
	gap: 0;
	font-size: 12px;
	line-height: 1;
	/* flex: 1; */
}

/* Grid row */
.summary-row {
	display: contents;
}

/* Grid cell base */
.summary-cell {
	padding: 3px 3px;
	display: flex;
	align-items: center;
	border-bottom: 1px solid #e0e0e0;
	background: white;
	min-height: 4.5mm;
}

/* Label header row styling - "Anteil" and "Z/N Wert" */
.summary-row-label-header {
	display: grid;
	grid-column: 1 / -1;
	grid-template-columns: var(--col-name) calc(var(--col-weight) + var(--col-percent)) calc(var(--col-zn-scatter) + var(--col-zn-value));
}

.summary-row-label-header .summary-cell {
	background: white;
	font-weight: var(--font-weight-bold);
	border-bottom: 1px solid #e0e0e0;
	justify-content: center;
	text-align: center;
}

.summary-row-label-header .cell-name {
	border-bottom: 1px solid #e0e0e0;
	border-right: none;
}

.cell-anteil-header {
	justify-content: center;
	text-align: center;
}

.cell-zn-wert-header {
	justify-content: center;
	text-align: center;
}

/* Total row styling - only spans left portion (no timeline) */
.summary-row-total {
	display: grid;
	grid-column: 1 / -1;
	grid-template-columns: var(--col-name) var(--col-weight) var(--col-percent) var(--col-zn-scatter) var(--col-zn-value);
}

.summary-row-total .summary-cell {
	font-weight: var(--font-weight-bold);
	background: #fafafa;
	border-bottom: 1px solid #333;
}

/* First element row - top border */
.summary-row-first .summary-cell {
	border-top: 1px solid #e0e0e0;
}

/* Footer row styling - axis labels + year labels */
.summary-row-footer .summary-cell {
	background: white;
	border-bottom: none;
	min-height: 5mm;
}

.summary-row-footer .cell-year-footer {
	height: 12mm;
	padding-top: 1mm;
	overflow: visible;
}

/* Last row - no bottom border */
.summary-row:last-child .summary-cell {
	border-bottom: none;
}

/* Cell-specific styling */
.cell-name {
	justify-content: flex-start;
	font-weight: var(--font-weight-medium);
}

.cell-weight-bar {
	justify-content: flex-end;
	padding: 2px 4px;
}

.weight-bar {
	height: 8px;
	background: #1890ff;
	border-radius: 1px;
}

.cell-percent {
	justify-content: flex-end;
	text-align: right;
	padding-right: 2mm;
}

/* -----------------------------------------------------------------------------
   Z/N SCATTER CHART CELL
   Horizontal axis from 100 (left) to 50 (right)
   7mm padding + 5 segments × 10mm = 57mm total (ticks only on 10s)
   ----------------------------------------------------------------------------- */

.cell-zn-scatter {
	position: relative;
	padding: 0;
	border-right: 1px solid #ccc;
}

/* Scatter axis container */
.zn-scatter-axis {
	position: relative;
	width: 100%;
	height: 100%;
	display: flex;
	align-items: center;
}

/* Left padding area (4mm) */
.zn-scatter-padding {
	width: 4mm;
	flex-shrink: 0;
}

/* Scale area (50mm for Z/N 100-50) */
.zn-scatter-scale {
	position: relative;
	width: 50mm;
	height: 100%;
	display: flex;
	align-items: center;
	overflow: visible;
}

/* Background color zones: 100-85 dark green, 85-70 light green, 70-50 orange */
.zn-scatter-background {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	display: flex;
}

.zn-bg-zone {
	height: 100%;
}

/* 100-85: 15mm (30% of 50mm) - lighter shade of dark green */
.zn-bg-good {
	width: 15mm;
	background-color: rgba(51, 135, 33, 0.2);
}

/* 85-70: 15mm (30% of 50mm) - lighter shade of light green */
.zn-bg-ok {
	width: 15mm;
	background-color: rgba(120, 192, 107, 0.2);
}

/* 70-50: 20mm (40% of 50mm) - lighter shade of orange */
.zn-bg-bad {
	width: 20mm;
	background-color: rgba(250, 167, 36, 0.2);
}

/* Axis labels in footer (100, 90, 80, 70, 60, 50) */
/* Labels are centered on tick lines using merged cell widths: 5mm-10mm-10mm-10mm-10mm-5mm */
.zn-scatter-labels {
	position: absolute;
	top: 1mm;
	left: 0;
	right: 0;
	bottom: 0;
	display: flex;
	align-items: flex-start;
}

.zn-axis-label {
	font-size: 12px;
	color: #666;
	text-align: center;
}

/* Edge labels (100 and 50) - centered ON the edge lines, overlapping outside */
.zn-axis-label:first-child,
.zn-axis-label:last-child {
	width: 5mm;
}

/* First label (100) - centered on 0mm line, extends left into padding */
.zn-axis-label:first-child {
	text-align: center;
	transform: translateX(-50%);
}

/* Last label (50) - centered on 50mm line, extends right beyond scale */
.zn-axis-label:last-child {
	text-align: center;
	transform: translateX(50%);
}

/* Middle labels (90, 80, 70, 60) - full width spanning across tick lines */
.zn-axis-label:not(:first-child):not(:last-child) {
	width: 10mm;
}

/* Footer cell for axis labels */
.cell-zn-axis-footer {
	border-bottom: none;
	border-right: none;
}

/* Axis tick marks - 5 segments × 10mm (only on 10s: 100, 90, 80, 70, 60, 50) */
.zn-scatter-ticks {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	display: flex;
}

.zn-tick {
	width: 10mm;
	border-left: 1px solid #333;
	height: 100%;
}

.zn-tick:last-child {
	border-right: 1px solid #333;
}

/* Condition dot positioned by Z/N value */
.zn-scatter-dot {
	position: absolute;
	width: 10px;
	height: 10px;
	border-radius: 50%;
	transform: translateX(-50%);
	top: 50%;
	margin-top: -5px;
}

/* Gap column between left panel and timeline */
.cell-gap {
	background: white;
	border-bottom: 1px dotted #e0e0e0;
}

/* Year columns - fixed 5mm width */
.cell-year {
	justify-content: center;
	padding: 1px 0;
	width: var(--col-year);
	border-left: 1px dashed #e0e0e0;
}

.cell-year:last-of-type {
	border-right: 1px dashed #e0e0e0;
}

/* Rotated year labels in footer - no vertical borders */
.cell-year-footer {
	height: 12mm;
	overflow: visible;
	align-items: flex-start;
	border-left: none;
	border-right: none;
}

.cell-year-footer:last-of-type {
	border-right: none;
}

.year-label {
	display: inline-block;
	writing-mode: vertical-rl;
	transform: rotate(180deg);
	font-size: 11.5px;
	/* Same as .zn-axis-label */
	font-weight: var(--font-weight-normal);
	line-height: 1;
	white-space: nowrap;
}

/* Renovation dot marker */
.restoration-dot {
	display: inline-block;
	width: 10px;
	height: 10px;
	background-color: #1a5fb4;
	border-radius: 50%;
}

/* Z/N value column (after scatter chart) */
.cell-zn {
	justify-content: center;
	text-align: center;
}


/* =============================================================================
   PRINT-SPECIFIC STYLES
   ============================================================================= */

@media print {
	.no-print {
		display: none !important;
	}

	/* For print, @page margin is 0 to prevent browser headers/footers */
	/* We handle spacing with CSS padding instead */
	.report-page {
		/* Full A4 landscape dimensions */
		width: 297mm;
		height: 210mm !important;
		min-height: 210mm !important;
		/* Content margins via padding (same as screen preview) */
		padding: var(--margin-top) var(--margin-right) var(--margin-bottom) var(--margin-left);
		box-sizing: border-box;
		box-shadow: none;
		/* Force browser to print background colors and images */
		-webkit-print-color-adjust: exact !important;
		print-color-adjust: exact !important;
		color-adjust: exact !important;
	}

	/* Ensure page content fills the page height */
	.report-page.report-page-content {
		height: 210mm !important;
	}

	/* Ensure body section fills remaining space for absolute positioning */
	.report-page-body {
		flex: 1;
		position: relative;
		min-height: 0;
	}

	/* Cover page body needs explicit height for absolute positioning to work */
	/* 210mm total - 30mm padding (top+bottom) - ~12mm header - ~12mm footer = ~156mm */
	.cover-page-body {
		height: 156mm !important;
		min-height: 156mm !important;
	}

	/* Recharts renders as SVG which prints correctly - no need to hide */
}

@media screen {

	/* On screen, hide print-only images */
	.chart-image-print {
		display: none;
	}

	/* WYSIWYG preview - each page is a complete A4 representation */
	.report-page {
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
		margin: 0 auto 20px auto;
		/* Center with gap between pages */
	}

}